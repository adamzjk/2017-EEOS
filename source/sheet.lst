     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 	EXTERN	_table_8_565
     9 00000000                                 [FILE "sheet.c"]
    10                                          [SECTION .text]
    11 00000000                                 	GLOBAL	_shtctl_init
    12 00000000                                 _shtctl_init:
    13 00000000 55                              	PUSH	EBP
    14 00000001 89 E5                           	MOV	EBP,ESP
    15 00000003 57                              	PUSH	EDI
    16 00000004 56                              	PUSH	ESI
    17 00000005 53                              	PUSH	EBX
    18 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    19 00000009 68 00002C14                     	PUSH	11284
    20 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    21 00000011 56                              	PUSH	ESI
    22 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    23 00000017 89 C3                           	MOV	EBX,EAX
    24 00000019 58                              	POP	EAX
    25 0000001A 5A                              	POP	EDX
    26 0000001B 85 DB                           	TEST	EBX,EBX
    27 0000001D 74 4A                           	JE	L3
    28 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    29 00000022 0F AF C7                        	IMUL	EAX,EDI
    30 00000025 50                              	PUSH	EAX
    31 00000026 56                              	PUSH	ESI
    32 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    33 0000002C 85 C0                           	TEST	EAX,EAX
    34 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    35 00000031 5A                              	POP	EDX
    36 00000032 59                              	POP	ECX
    37 00000033 74 3E                           	JE	L11
    38 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    39 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    40 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    41 0000003D 8D 93 000027D8                  	LEA	EDX,DWORD [10200+EBX]
    42 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    43 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    44 00000049 89 D8                           	MOV	EAX,EBX
    45 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    46 00000052                                 L9:
    47 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    48 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    49 00000062 83 C0 28                        	ADD	EAX,40
    50 00000065 39 D0                           	CMP	EAX,EDX
    51 00000067 7E E9                           	JLE	L9
    52 00000069                                 L3:
    53 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    54 0000006C 89 D8                           	MOV	EAX,EBX
    55 0000006E 5B                              	POP	EBX
    56 0000006F 5E                              	POP	ESI
    57 00000070 5F                              	POP	EDI
    58 00000071 5D                              	POP	EBP
    59 00000072 C3                              	RET
    60 00000073                                 L11:
    61 00000073 68 00002C14                     	PUSH	11284
    62 00000078 53                              	PUSH	EBX
    63 00000079 56                              	PUSH	ESI
    64 0000007A E8 [00000000]                   	CALL	_memman_free_4k
    65 0000007F 83 C4 0C                        	ADD	ESP,12
    66 00000082 EB E5                           	JMP	L3
    67 00000084                                 	GLOBAL	_sheet_alloc
    68 00000084                                 _sheet_alloc:
    69 00000084 55                              	PUSH	EBP
    70 00000085 31 D2                           	XOR	EDX,EDX
    71 00000087 89 E5                           	MOV	EBP,ESP
    72 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    73 0000008C 05 00000414                     	ADD	EAX,1044
    74 00000091                                 L18:
    75 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    76 00000095 74 10                           	JE	L21
    77 00000097 42                              	INC	EDX
    78 00000098 83 C0 28                        	ADD	EAX,40
    79 0000009B 81 FA 000000FF                  	CMP	EDX,255
    80 000000A1 7E EE                           	JLE	L18
    81 000000A3 31 C0                           	XOR	EAX,EAX
    82 000000A5                                 L12:
    83 000000A5 5D                              	POP	EBP
    84 000000A6 C3                              	RET
    85 000000A7                                 L21:
    86 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    87 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    88 000000B5 EB EE                           	JMP	L12
    89 000000B7                                 	GLOBAL	_sheet_setbuf
    90 000000B7                                 _sheet_setbuf:
    91 000000B7 55                              	PUSH	EBP
    92 000000B8 89 E5                           	MOV	EBP,ESP
    93 000000BA 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    94 000000BD 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    95 000000C0 8B 4D 18                        	MOV	ECX,DWORD [24+EBP]
    96 000000C3 89 02                           	MOV	DWORD [EDX],EAX
    97 000000C5 83 F9 FF                        	CMP	ECX,-1
    98 000000C8 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    99 000000CB 89 42 04                        	MOV	DWORD [4+EDX],EAX
   100 000000CE 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   101 000000D1 89 42 08                        	MOV	DWORD [8+EDX],EAX
   102 000000D4 74 0D                           	JE	L23
   103 000000D6 0F B7 84 09 [00000000]          	MOVZX	EAX,WORD [_table_8_565+ECX+ECX*1]
   104 000000DE 89 42 14                        	MOV	DWORD [20+EDX],EAX
   105 000000E1                                 L22:
   106 000000E1 5D                              	POP	EBP
   107 000000E2 C3                              	RET
   108 000000E3                                 L23:
   109 000000E3 C7 42 14 FFFFFFFF               	MOV	DWORD [20+EDX],-1
   110 000000EA EB F5                           	JMP	L22
   111 000000EC                                 	GLOBAL	_sheet_refreshmap
   112 000000EC                                 _sheet_refreshmap:
   113 000000EC 55                              	PUSH	EBP
   114 000000ED 89 E5                           	MOV	EBP,ESP
   115 000000EF 57                              	PUSH	EDI
   116 000000F0 56                              	PUSH	ESI
   117 000000F1 53                              	PUSH	EBX
   118 000000F2 83 EC 30                        	SUB	ESP,48
   119 000000F5 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   120 000000F8 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   121 000000FC 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   122 000000FF 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   123 00000102 0F 88 00000203                  	JS	L85
   124 00000108                                 L26:
   125 00000108 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   126 0000010C 0F 88 000001ED                  	JS	L86
   127 00000112                                 L27:
   128 00000112 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   129 00000115 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   130 00000118 39 45 14                        	CMP	DWORD [20+EBP],EAX
   131 0000011B 7E 03                           	JLE	L28
   132 0000011D 89 45 14                        	MOV	DWORD [20+EBP],EAX
   133 00000120                                 L28:
   134 00000120 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   135 00000123 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   136 00000126 39 45 18                        	CMP	DWORD [24+EBP],EAX
   137 00000129 7E 03                           	JLE	L29
   138 0000012B 89 45 18                        	MOV	DWORD [24+EBP],EAX
   139 0000012E                                 L29:
   140 0000012E 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   141 00000131 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   142 00000134 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   143 00000137 3B 5E 10                        	CMP	EBX,DWORD [16+ESI]
   144 0000013A 0F 8F 000000DA                  	JG	L75
   145 00000140                                 L73:
   146 00000140 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   147 00000143 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   148 00000146 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   149 00000149 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   150 0000014C 8B 7C 82 14                     	MOV	EDI,DWORD [20+EDX+EAX*4]
   151 00000150 89 F8                           	MOV	EAX,EDI
   152 00000152 29 D0                           	SUB	EAX,EDX
   153 00000154 8B 0F                           	MOV	ECX,DWORD [EDI]
   154 00000156 2D 00000414                     	SUB	EAX,1044
   155 0000015B 89 4D D4                        	MOV	DWORD [-44+EBP],ECX
   156 0000015E C1 F8 03                        	SAR	EAX,3
   157 00000161 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   158 00000164 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   159 0000016A 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   160 0000016D 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   161 00000170 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   162 00000173 29 D3                           	SUB	EBX,EDX
   163 00000175 29 C6                           	SUB	ESI,EAX
   164 00000177 29 C1                           	SUB	ECX,EAX
   165 00000179 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   166 0000017C 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   167 0000017F 29 D0                           	SUB	EAX,EDX
   168 00000181 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   169 00000184 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   170 00000187 0F 88 00000166                  	JS	L87
   171 0000018D                                 L34:
   172 0000018D 85 C9                           	TEST	ECX,ECX
   173 0000018F 0F 88 00000157                  	JS	L88
   174 00000195                                 L35:
   175 00000195 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   176 00000198 39 45 E8                        	CMP	DWORD [-24+EBP],EAX
   177 0000019B 7E 03                           	JLE	L36
   178 0000019D 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   179 000001A0                                 L36:
   180 000001A0 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   181 000001A3 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   182 000001A6 7E 03                           	JLE	L37
   183 000001A8 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   184 000001AB                                 L37:
   185 000001AB 83 7F 14 FF                     	CMP	DWORD [20+EDI],-1
   186 000001AF 74 71                           	JE	L89
   187 000001B1 89 CA                           	MOV	EDX,ECX
   188 000001B3 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   189 000001B6 7D 50                           	JGE	L32
   190 000001B8                                 L72:
   191 000001B8 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   192 000001BB 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   193 000001BE 01 D0                           	ADD	EAX,EDX
   194 000001C0 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   195 000001C3 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   196 000001C6 7D 3A                           	JGE	L84
   197 000001C8                                 L71:
   198 000001C8 89 D0                           	MOV	EAX,EDX
   199 000001CA 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   200 000001CD 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   201 000001D1 01 C8                           	ADD	EAX,ECX
   202 000001D3 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   203 000001D6 01 CB                           	ADD	EBX,ECX
   204 000001D8 0F B7 34 46                     	MOVZX	ESI,WORD [ESI+EAX*2]
   205 000001DC 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   206 000001DF 3B 77 14                        	CMP	ESI,DWORD [20+EDI]
   207 000001E2 74 18                           	JE	L68
   208 000001E4 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   209 000001E7 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   210 000001EA 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   211 000001ED 0F AF 58 08                     	IMUL	EBX,DWORD [8+EAX]
   212 000001F1 01 DE                           	ADD	ESI,EBX
   213 000001F3 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   214 000001F6 8B 5D D8                        	MOV	EBX,DWORD [-40+EBP]
   215 000001F9 88 04 1E                        	MOV	BYTE [ESI+EBX*1],AL
   216 000001FC                                 L68:
   217 000001FC 41                              	INC	ECX
   218 000001FD 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   219 00000200 7C C6                           	JL	L71
   220 00000202                                 L84:
   221 00000202 42                              	INC	EDX
   222 00000203 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   223 00000206 7C B0                           	JL	L72
   224 00000208                                 L32:
   225 00000208 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   226 0000020B FF 45 F0                        	INC	DWORD [-16+EBP]
   227 0000020E 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   228 00000211 3B 70 10                        	CMP	ESI,DWORD [16+EAX]
   229 00000214 0F 8E FFFFFF26                  	JLE	L73
   230 0000021A                                 L75:
   231 0000021A 83 C4 30                        	ADD	ESP,48
   232 0000021D 5B                              	POP	EBX
   233 0000021E 5E                              	POP	ESI
   234 0000021F 5F                              	POP	EDI
   235 00000220 5D                              	POP	EBP
   236 00000221 C3                              	RET
   237 00000222                                 L89:
   238 00000222 83 E2 03                        	AND	EDX,3
   239 00000225 75 7F                           	JNE	L39
   240 00000227 F7 45 EC 00000003               	TEST	DWORD [-20+EBP],3
   241 0000022E 75 76                           	JNE	L39
   242 00000230 F7 45 E8 00000003               	TEST	DWORD [-24+EBP],3
   243 00000237 75 6D                           	JNE	L39
   244 00000239 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   245 0000023C 29 55 E8                        	SUB	DWORD [-24+EBP],EDX
   246 0000023F BA 00000004                     	MOV	EDX,4
   247 00000244 89 D3                           	MOV	EBX,EDX
   248 00000246 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   249 00000249 99                              	CDQ
   250 0000024A F7 FB                           	IDIV	EBX
   251 0000024C 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   252 0000024F 89 CA                           	MOV	EDX,ECX
   253 00000251 0F B6 45 DF                     	MOVZX	EAX,BYTE [-33+EBP]
   254 00000255 89 C6                           	MOV	ESI,EAX
   255 00000257 C1 E6 08                        	SAL	ESI,8
   256 0000025A 09 C6                           	OR	ESI,EAX
   257 0000025C C1 E0 10                        	SAL	EAX,16
   258 0000025F 09 C6                           	OR	ESI,EAX
   259 00000261 C1 E0 08                        	SAL	EAX,8
   260 00000264 09 C6                           	OR	ESI,EAX
   261 00000266 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   262 00000269 89 75 E0                        	MOV	DWORD [-32+EBP],ESI
   263 0000026C 7D 9A                           	JGE	L32
   264 0000026E                                 L49:
   265 0000026E 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   266 00000271 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   267 00000274 01 D0                           	ADD	EAX,EDX
   268 00000276 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   269 00000279 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   270 0000027D 03 4F 0C                        	ADD	ECX,DWORD [12+EDI]
   271 00000280 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   272 00000283 01 C8                           	ADD	EAX,ECX
   273 00000285 31 C9                           	XOR	ECX,ECX
   274 00000287 03 45 D8                        	ADD	EAX,DWORD [-40+EBP]
   275 0000028A 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   276 0000028D 7D 0C                           	JGE	L78
   277 0000028F                                 L48:
   278 0000028F 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   279 00000292 89 34 88                        	MOV	DWORD [EAX+ECX*4],ESI
   280 00000295 41                              	INC	ECX
   281 00000296 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   282 00000299 7C F4                           	JL	L48
   283 0000029B                                 L78:
   284 0000029B 42                              	INC	EDX
   285 0000029C 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   286 0000029F 7C CD                           	JL	L49
   287 000002A1 E9 FFFFFF62                     	JMP	L32
   288 000002A6                                 L39:
   289 000002A6 89 CA                           	MOV	EDX,ECX
   290 000002A8 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   291 000002AB 0F 8D FFFFFF57                  	JGE	L32
   292 000002B1                                 L60:
   293 000002B1 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   294 000002B4 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   295 000002B7 01 D0                           	ADD	EAX,EDX
   296 000002B9 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   297 000002BC 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   298 000002BF 7D 20                           	JGE	L81
   299 000002C1                                 L59:
   300 000002C1 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   301 000002C4 8B 45 C4                        	MOV	EAX,DWORD [-60+EBP]
   302 000002C7 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   303 000002CA 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   304 000002CE 01 CB                           	ADD	EBX,ECX
   305 000002D0 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   306 000002D3 01 C3                           	ADD	EBX,EAX
   307 000002D5 41                              	INC	ECX
   308 000002D6 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   309 000002D9 88 04 33                        	MOV	BYTE [EBX+ESI*1],AL
   310 000002DC 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   311 000002DF 7C E0                           	JL	L59
   312 000002E1                                 L81:
   313 000002E1 42                              	INC	EDX
   314 000002E2 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   315 000002E5 7C CA                           	JL	L60
   316 000002E7 E9 FFFFFF1C                     	JMP	L32
   317 000002EC                                 L88:
   318 000002EC 31 C9                           	XOR	ECX,ECX
   319 000002EE E9 FFFFFEA2                     	JMP	L35
   320 000002F3                                 L87:
   321 000002F3 C7 45 EC 00000000               	MOV	DWORD [-20+EBP],0
   322 000002FA E9 FFFFFE8E                     	JMP	L34
   323 000002FF                                 L86:
   324 000002FF C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   325 00000306 E9 FFFFFE07                     	JMP	L27
   326 0000030B                                 L85:
   327 0000030B C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   328 00000312 E9 FFFFFDF1                     	JMP	L26
   329 00000317                                 	GLOBAL	_sheet_refreshsub
   330 00000317                                 _sheet_refreshsub:
   331 00000317 55                              	PUSH	EBP
   332 00000318 89 E5                           	MOV	EBP,ESP
   333 0000031A 57                              	PUSH	EDI
   334 0000031B 56                              	PUSH	ESI
   335 0000031C 53                              	PUSH	EBX
   336 0000031D 83 EC 54                        	SUB	ESP,84
   337 00000320 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   338 00000323 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   339 00000326 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   340 0000032A 8B 00                           	MOV	EAX,DWORD [EAX]
   341 0000032C 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   342 0000032F 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   343 00000332 89 55 CC                        	MOV	DWORD [-52+EBP],EDX
   344 00000335 0F 88 000003AD                  	JS	L171
   345 0000033B                                 L91:
   346 0000033B 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   347 0000033F 0F 88 00000397                  	JS	L172
   348 00000345                                 L92:
   349 00000345 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   350 00000348 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   351 0000034B 39 45 14                        	CMP	DWORD [20+EBP],EAX
   352 0000034E 7E 03                           	JLE	L93
   353 00000350 89 45 14                        	MOV	DWORD [20+EBP],EAX
   354 00000353                                 L93:
   355 00000353 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   356 00000356 8B 42 0C                        	MOV	EAX,DWORD [12+EDX]
   357 00000359 39 45 18                        	CMP	DWORD [24+EBP],EAX
   358 0000035C 7E 03                           	JLE	L94
   359 0000035E 89 45 18                        	MOV	DWORD [24+EBP],EAX
   360 00000361                                 L94:
   361 00000361 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   362 00000364 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   363 00000367 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   364 0000036A 39 C3                           	CMP	EBX,EAX
   365 0000036C 0F 8F 000001F6                  	JG	L158
   366 00000372                                 L156:
   367 00000372 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   368 00000375 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   369 00000378 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   370 0000037B 8B 7C 93 14                     	MOV	EDI,DWORD [20+EBX+EDX*4]
   371 0000037F 8B 07                           	MOV	EAX,DWORD [EDI]
   372 00000381 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   373 00000384 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   374 00000387 89 55 B8                        	MOV	DWORD [-72+EBP],EDX
   375 0000038A 89 F8                           	MOV	EAX,EDI
   376 0000038C 29 D8                           	SUB	EAX,EBX
   377 0000038E 8B 5F 10                        	MOV	EBX,DWORD [16+EDI]
   378 00000391 2D 00000414                     	SUB	EAX,1044
   379 00000396 29 D9                           	SUB	ECX,EBX
   380 00000398 C1 F8 03                        	SAR	EAX,3
   381 0000039B 89 5D B4                        	MOV	DWORD [-76+EBP],EBX
   382 0000039E 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   383 000003A4 88 45 CB                        	MOV	BYTE [-53+EBP],AL
   384 000003A7 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   385 000003AA 29 D0                           	SUB	EAX,EDX
   386 000003AC 8B 55 18                        	MOV	EDX,DWORD [24+EBP]
   387 000003AF 29 DA                           	SUB	EDX,EBX
   388 000003B1 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   389 000003B4 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   390 000003B7 89 55 E0                        	MOV	DWORD [-32+EBP],EDX
   391 000003BA 2B 5D B8                        	SUB	EBX,DWORD [-72+EBP]
   392 000003BD 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   393 000003C0 0F 88 0000030A                  	JS	L173
   394 000003C6                                 L99:
   395 000003C6 85 C9                           	TEST	ECX,ECX
   396 000003C8 0F 88 000002FB                  	JS	L174
   397 000003CE                                 L100:
   398 000003CE 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   399 000003D1 89 45 B0                        	MOV	DWORD [-80+EBP],EAX
   400 000003D4 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   401 000003D7 7E 03                           	JLE	L101
   402 000003D9 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   403 000003DC                                 L101:
   404 000003DC 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   405 000003DF 39 45 E0                        	CMP	DWORD [-32+EBP],EAX
   406 000003E2 7E 03                           	JLE	L102
   407 000003E4 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   408 000003E7                                 L102:
   409 000003E7 80 3D 00000FF2 08               	CMP	BYTE [4082],8
   410 000003EE 0F 84 00000276                  	JE	L175
   411 000003F4 F7 45 B8 00000002               	TEST	DWORD [-72+EBP],2
   412 000003FB 0F 85 000001F3                  	JNE	L116
   413 00000401 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   414 00000404 BE 00000002                     	MOV	ESI,2
   415 00000409 42                              	INC	EDX
   416 0000040A 89 D0                           	MOV	EAX,EDX
   417 0000040C 99                              	CDQ
   418 0000040D F7 FE                           	IDIV	ESI
   419 0000040F 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   420 00000412 8B 45 E4                        	MOV	EAX,DWORD [-28+EBP]
   421 00000415 99                              	CDQ
   422 00000416 F7 FE                           	IDIV	ESI
   423 00000418 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   424 0000041B 89 CE                           	MOV	ESI,ECX
   425 0000041D 29 D0                           	SUB	EAX,EDX
   426 0000041F 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   427 00000422 66 0F B6 5D CB                  	MOVZX	BX,BYTE [-53+EBP]
   428 00000427 0F B6 45 CB                     	MOVZX	EAX,BYTE [-53+EBP]
   429 0000042B C1 E0 08                        	SAL	EAX,8
   430 0000042E 66 89 5D C2                     	MOV	WORD [-62+EBP],BX
   431 00000432 66 09 45 C2                     	OR	WORD [-62+EBP],AX
   432 00000436 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   433 00000439 0F 8D 0000011A                  	JGE	L97
   434 0000043F                                 L143:
   435 0000043F 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   436 00000442 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   437 00000445 01 F0                           	ADD	EAX,ESI
   438 00000447 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   439 0000044A 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   440 0000044D 7D 37                           	JGE	L122
   441 0000044F F7 C1 00000001                  	TEST	ECX,1
   442 00000455 74 2F                           	JE	L122
   443 00000457                                 L127:
   444 00000457 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   445 0000045A 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   446 0000045D 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   447 00000460 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   448 00000464 01 CA                           	ADD	EDX,ECX
   449 00000466 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   450 00000469 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   451 0000046C 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   452 0000046F 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   453 00000472 0F 84 00000161                  	JE	L176
   454 00000478                                 L123:
   455 00000478 41                              	INC	ECX
   456 00000479 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   457 0000047C 7D 08                           	JGE	L122
   458 0000047E F7 C1 00000001                  	TEST	ECX,1
   459 00000484 75 D1                           	JNE	L127
   460 00000486                                 L122:
   461 00000486 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   462 00000489 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   463 0000048C 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   464 0000048F 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   465 00000493 01 CA                           	ADD	EDX,ECX
   466 00000495 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   467 00000498 01 D0                           	ADD	EAX,EDX
   468 0000049A 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   469 0000049D 01 C2                           	ADD	EDX,EAX
   470 0000049F 8D 04 43                        	LEA	EAX,DWORD [EBX+EAX*2]
   471 000004A2 89 55 BC                        	MOV	DWORD [-68+EBP],EDX
   472 000004A5 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   473 000004A8 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   474 000004AB 89 F0                           	MOV	EAX,ESI
   475 000004AD 8B 5D DC                        	MOV	EBX,DWORD [-36+EBP]
   476 000004B0 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   477 000004B4 01 C8                           	ADD	EAX,ECX
   478 000004B6 C7 45 A0 00000000               	MOV	DWORD [-96+EBP],0
   479 000004BD 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   480 000004C0 39 5D A0                        	CMP	DWORD [-96+EBP],EBX
   481 000004C3 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   482 000004C6 7D 59                           	JGE	L165
   483 000004C8 89 4D AC                        	MOV	DWORD [-84+EBP],ECX
   484 000004CB                                 L136:
   485 000004CB 66 8B 5D C2                     	MOV	BX,WORD [-62+EBP]
   486 000004CF 8B 45 A0                        	MOV	EAX,DWORD [-96+EBP]
   487 000004D2 8B 55 BC                        	MOV	EDX,DWORD [-68+EBP]
   488 000004D5 66 39 1C 42                     	CMP	WORD [EDX+EAX*2],BX
   489 000004D9 0F 84 000000E6                  	JE	L177
   490 000004DF 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   491 000004E2 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   492 000004E5 8B 55 AC                        	MOV	EDX,DWORD [-84+EBP]
   493 000004E8 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   494 000004EC 03 57 0C                        	ADD	EDX,DWORD [12+EDI]
   495 000004EF 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   496 000004F2 01 C2                           	ADD	EDX,EAX
   497 000004F4 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   498 000004F7 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   499 000004FA 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   500 000004FD 0F 84 000000A3                  	JE	L178
   501 00000503                                 L134:
   502 00000503 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   503 00000506 8B 55 A4                        	MOV	EDX,DWORD [-92+EBP]
   504 00000509 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   505 0000050C 38 5C 02 01                     	CMP	BYTE [1+EDX+EAX*1],BL
   506 00000510 74 76                           	JE	L179
   507 00000512                                 L130:
   508 00000512 8B 45 DC                        	MOV	EAX,DWORD [-36+EBP]
   509 00000515 FF 45 A0                        	INC	DWORD [-96+EBP]
   510 00000518 83 45 AC 02                     	ADD	DWORD [-84+EBP],2
   511 0000051C 39 45 A0                        	CMP	DWORD [-96+EBP],EAX
   512 0000051F 7C AA                           	JL	L136
   513 00000521                                 L165:
   514 00000521 8B 55 DC                        	MOV	EDX,DWORD [-36+EBP]
   515 00000524 8D 0C 51                        	LEA	ECX,DWORD [ECX+EDX*2]
   516 00000527 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   517 0000052A 7D 23                           	JGE	L167
   518 0000052C                                 L142:
   519 0000052C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   520 0000052F 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   521 00000532 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   522 00000535 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   523 00000539 01 CA                           	ADD	EDX,ECX
   524 0000053B 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   525 0000053E 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   526 00000541 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   527 00000544 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   528 00000547 74 27                           	JE	L180
   529 00000549                                 L139:
   530 00000549 41                              	INC	ECX
   531 0000054A 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   532 0000054D 7C DD                           	JL	L142
   533 0000054F                                 L167:
   534 0000054F 46                              	INC	ESI
   535 00000550 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   536 00000553 0F 8C FFFFFEE6                  	JL	L143
   537 00000559                                 L97:
   538 00000559 8B 5D 20                        	MOV	EBX,DWORD [32+EBP]
   539 0000055C FF 45 F0                        	INC	DWORD [-16+EBP]
   540 0000055F 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   541 00000562 0F 8E FFFFFE0A                  	JLE	L156
   542 00000568                                 L158:
   543 00000568 83 C4 54                        	ADD	ESP,84
   544 0000056B 5B                              	POP	EBX
   545 0000056C 5E                              	POP	ESI
   546 0000056D 5F                              	POP	EDI
   547 0000056E 5D                              	POP	EBP
   548 0000056F C3                              	RET
   549 00000570                                 L180:
   550 00000570 89 F0                           	MOV	EAX,ESI
   551 00000572 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   552 00000575 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   553 00000579 01 C8                           	ADD	EAX,ECX
   554 0000057B 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   555 0000057F 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   556 00000582 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   557 00000586 EB C1                           	JMP	L139
   558 00000588                                 L179:
   559 00000588 89 F0                           	MOV	EAX,ESI
   560 0000058A 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   561 0000058D 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   562 00000591 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   563 00000594 66 8B 44 43 02                  	MOV	AX,WORD [2+EBX+EAX*2]
   564 00000599 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   565 0000059C 66 89 44 53 02                  	MOV	WORD [2+EBX+EDX*2],AX
   566 000005A1 E9 FFFFFF6C                     	JMP	L130
   567 000005A6                                 L178:
   568 000005A6 89 F0                           	MOV	EAX,ESI
   569 000005A8 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   570 000005AB 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   571 000005AF 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   572 000005B2 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   573 000005B5 66 8B 04 42                     	MOV	AX,WORD [EDX+EAX*2]
   574 000005B9 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   575 000005BC 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   576 000005C0 E9 FFFFFF3E                     	JMP	L134
   577 000005C5                                 L177:
   578 000005C5 8B 55 D4                        	MOV	EDX,DWORD [-44+EBP]
   579 000005C8 8B 5D A0                        	MOV	EBX,DWORD [-96+EBP]
   580 000005CB 8B 04 82                        	MOV	EAX,DWORD [EDX+EAX*4]
   581 000005CE 8B 55 D8                        	MOV	EDX,DWORD [-40+EBP]
   582 000005D1 89 04 9A                        	MOV	DWORD [EDX+EBX*4],EAX
   583 000005D4 E9 FFFFFF39                     	JMP	L130
   584 000005D9                                 L176:
   585 000005D9 89 F0                           	MOV	EAX,ESI
   586 000005DB 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   587 000005DE 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   588 000005E2 01 C8                           	ADD	EAX,ECX
   589 000005E4 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   590 000005E8 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   591 000005EB 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   592 000005EF E9 FFFFFE84                     	JMP	L123
   593 000005F4                                 L116:
   594 000005F4 89 CE                           	MOV	ESI,ECX
   595 000005F6 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   596 000005F9 0F 8D FFFFFF5A                  	JGE	L97
   597 000005FF 8B 7D B0                        	MOV	EDI,DWORD [-80+EBP]
   598 00000602 0F AF F9                        	IMUL	EDI,ECX
   599 00000605                                 L155:
   600 00000605 8B 45 B4                        	MOV	EAX,DWORD [-76+EBP]
   601 00000608 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   602 0000060B 01 F0                           	ADD	EAX,ESI
   603 0000060D 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   604 00000610 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   605 00000613 7D 35                           	JGE	L170
   606 00000615 8D 04 39                        	LEA	EAX,DWORD [ECX+EDI*1]
   607 00000618 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   608 0000061B 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   609 0000061E 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   610 00000621                                 L154:
   611 00000621 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   612 00000624 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   613 00000627 8B 55 B8                        	MOV	EDX,DWORD [-72+EBP]
   614 0000062A 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   615 0000062E 01 CA                           	ADD	EDX,ECX
   616 00000630 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   617 00000633 01 C2                           	ADD	EDX,EAX
   618 00000635 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   619 00000638 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   620 0000063B 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   621 0000063E 74 18                           	JE	L181
   622 00000640                                 L151:
   623 00000640 41                              	INC	ECX
   624 00000641 83 45 A0 02                     	ADD	DWORD [-96+EBP],2
   625 00000645 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   626 00000648 7C D7                           	JL	L154
   627 0000064A                                 L170:
   628 0000064A 46                              	INC	ESI
   629 0000064B 03 7D B0                        	ADD	EDI,DWORD [-80+EBP]
   630 0000064E 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   631 00000651 7C B2                           	JL	L155
   632 00000653 E9 FFFFFF01                     	JMP	L97
   633 00000658                                 L181:
   634 00000658 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   635 0000065B 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   636 0000065E 66 8B 02                        	MOV	AX,WORD [EDX]
   637 00000661 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   638 00000664 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   639 00000668 EB D6                           	JMP	L151
   640 0000066A                                 L175:
   641 0000066A 89 CE                           	MOV	ESI,ECX
   642 0000066C 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   643 0000066F 0F 8D FFFFFEE4                  	JGE	L97
   644 00000675                                 L114:
   645 00000675 8B 57 10                        	MOV	EDX,DWORD [16+EDI]
   646 00000678 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   647 0000067B 01 F2                           	ADD	EDX,ESI
   648 0000067D 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   649 00000680 89 55 EC                        	MOV	DWORD [-20+EBP],EDX
   650 00000683 7D 23                           	JGE	L161
   651 00000685                                 L113:
   652 00000685 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   653 00000688 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   654 0000068B 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   655 0000068E 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   656 00000692 01 CA                           	ADD	EDX,ECX
   657 00000694 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   658 00000697 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   659 0000069A 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   660 0000069D 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   661 000006A0 74 11                           	JE	L182
   662 000006A2                                 L110:
   663 000006A2 41                              	INC	ECX
   664 000006A3 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   665 000006A6 7C DD                           	JL	L113
   666 000006A8                                 L161:
   667 000006A8 46                              	INC	ESI
   668 000006A9 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   669 000006AC 7C C7                           	JL	L114
   670 000006AE E9 FFFFFEA6                     	JMP	L97
   671 000006B3                                 L182:
   672 000006B3 89 F0                           	MOV	EAX,ESI
   673 000006B5 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   674 000006B8 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   675 000006BC 01 C8                           	ADD	EAX,ECX
   676 000006BE 8A 04 43                        	MOV	AL,BYTE [EBX+EAX*2]
   677 000006C1 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   678 000006C4 88 04 1A                        	MOV	BYTE [EDX+EBX*1],AL
   679 000006C7 EB D9                           	JMP	L110
   680 000006C9                                 L174:
   681 000006C9 31 C9                           	XOR	ECX,ECX
   682 000006CB E9 FFFFFCFE                     	JMP	L100
   683 000006D0                                 L173:
   684 000006D0 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   685 000006D7 E9 FFFFFCEA                     	JMP	L99
   686 000006DC                                 L172:
   687 000006DC C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   688 000006E3 E9 FFFFFC5D                     	JMP	L92
   689 000006E8                                 L171:
   690 000006E8 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   691 000006EF E9 FFFFFC47                     	JMP	L91
   692 000006F4                                 	GLOBAL	_sheet_updown
   693 000006F4                                 _sheet_updown:
   694 000006F4 55                              	PUSH	EBP
   695 000006F5 89 E5                           	MOV	EBP,ESP
   696 000006F7 57                              	PUSH	EDI
   697 000006F8 56                              	PUSH	ESI
   698 000006F9 53                              	PUSH	EBX
   699 000006FA 51                              	PUSH	ECX
   700 000006FB 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   701 000006FE 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   702 00000701 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   703 00000704 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   704 00000707 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   705 0000070A 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   706 0000070D 40                              	INC	EAX
   707 0000070E 39 C3                           	CMP	EBX,EAX
   708 00000710 7E 02                           	JLE	L184
   709 00000712 89 C3                           	MOV	EBX,EAX
   710 00000714                                 L184:
   711 00000714 83 FB FF                        	CMP	EBX,-1
   712 00000717 7D 03                           	JGE	L185
   713 00000719 83 CB FF                        	OR	EBX,-1
   714 0000071C                                 L185:
   715 0000071C 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   716 0000071F 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   717 00000722 0F 8E 000000A8                  	JLE	L186
   718 00000728 85 DB                           	TEST	EBX,EBX
   719 0000072A 78 5C                           	JS	L187
   720 0000072C 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   721 0000072F                                 L192:
   722 0000072F 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   723 00000733 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   724 00000737 89 48 18                        	MOV	DWORD [24+EAX],ECX
   725 0000073A 49                              	DEC	ECX
   726 0000073B 39 D9                           	CMP	ECX,EBX
   727 0000073D 7F F0                           	JG	L192
   728 0000073F 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   729 00000743 43                              	INC	EBX
   730 00000744 53                              	PUSH	EBX
   731 00000745 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   732 00000748 89 C8                           	MOV	EAX,ECX
   733 0000074A 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   734 0000074D 50                              	PUSH	EAX
   735 0000074E 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   736 00000751 89 D0                           	MOV	EAX,EDX
   737 00000753 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   738 00000756 50                              	PUSH	EAX
   739 00000757 51                              	PUSH	ECX
   740 00000758 52                              	PUSH	EDX
   741 00000759 56                              	PUSH	ESI
   742 0000075A E8 FFFFF98D                     	CALL	_sheet_refreshmap
   743 0000075F FF 75 F0                        	PUSH	DWORD [-16+EBP]
   744 00000762                                 L222:
   745 00000762 53                              	PUSH	EBX
   746 00000763                                 L221:
   747 00000763 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   748 00000766 89 C8                           	MOV	EAX,ECX
   749 00000768 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   750 0000076B 50                              	PUSH	EAX
   751 0000076C 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   752 0000076F 89 D0                           	MOV	EAX,EDX
   753 00000771 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   754 00000774 50                              	PUSH	EAX
   755 00000775 51                              	PUSH	ECX
   756 00000776 52                              	PUSH	EDX
   757 00000777 56                              	PUSH	ESI
   758 00000778 E8 FFFFFB9A                     	CALL	_sheet_refreshsub
   759 0000077D 83 C4 34                        	ADD	ESP,52
   760 00000780                                 L183:
   761 00000780 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   762 00000783 5B                              	POP	EBX
   763 00000784 5E                              	POP	ESI
   764 00000785 5F                              	POP	EDI
   765 00000786 5D                              	POP	EBP
   766 00000787 C3                              	RET
   767 00000788                                 L187:
   768 00000788 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   769 0000078B 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   770 0000078E 7E 18                           	JLE	L194
   771 00000790 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   772 00000793 39 C1                           	CMP	ECX,EAX
   773 00000795 7D 11                           	JGE	L194
   774 00000797                                 L199:
   775 00000797 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   776 0000079B 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   777 0000079F 89 48 18                        	MOV	DWORD [24+EAX],ECX
   778 000007A2 41                              	INC	ECX
   779 000007A3 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   780 000007A6 7C EF                           	JL	L199
   781 000007A8                                 L194:
   782 000007A8 FF 4E 10                        	DEC	DWORD [16+ESI]
   783 000007AB 6A 00                           	PUSH	0
   784 000007AD 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   785 000007B0 89 C8                           	MOV	EAX,ECX
   786 000007B2 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   787 000007B5 50                              	PUSH	EAX
   788 000007B6 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   789 000007B9 89 D0                           	MOV	EAX,EDX
   790 000007BB 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   791 000007BE 50                              	PUSH	EAX
   792 000007BF 51                              	PUSH	ECX
   793 000007C0 52                              	PUSH	EDX
   794 000007C1 56                              	PUSH	ESI
   795 000007C2 E8 FFFFF925                     	CALL	_sheet_refreshmap
   796 000007C7 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   797 000007CA 48                              	DEC	EAX
   798 000007CB 50                              	PUSH	EAX
   799 000007CC 6A 00                           	PUSH	0
   800 000007CE EB 93                           	JMP	L221
   801 000007D0                                 L186:
   802 000007D0 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   803 000007D3 7D AB                           	JGE	L183
   804 000007D5 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   805 000007D9 78 3C                           	JS	L202
   806 000007DB 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   807 000007DE 39 D9                           	CMP	ECX,EBX
   808 000007E0 7D 10                           	JGE	L218
   809 000007E2                                 L207:
   810 000007E2 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   811 000007E6 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   812 000007EA 89 48 18                        	MOV	DWORD [24+EAX],ECX
   813 000007ED 41                              	INC	ECX
   814 000007EE 39 D9                           	CMP	ECX,EBX
   815 000007F0 7C F0                           	JL	L207
   816 000007F2                                 L218:
   817 000007F2 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   818 000007F6                                 L208:
   819 000007F6 53                              	PUSH	EBX
   820 000007F7 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   821 000007FA 89 C8                           	MOV	EAX,ECX
   822 000007FC 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   823 000007FF 50                              	PUSH	EAX
   824 00000800 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   825 00000803 89 D0                           	MOV	EAX,EDX
   826 00000805 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   827 00000808 50                              	PUSH	EAX
   828 00000809 51                              	PUSH	ECX
   829 0000080A 52                              	PUSH	EDX
   830 0000080B 56                              	PUSH	ESI
   831 0000080C E8 FFFFF8DB                     	CALL	_sheet_refreshmap
   832 00000811 53                              	PUSH	EBX
   833 00000812 E9 FFFFFF4B                     	JMP	L222
   834 00000817                                 L202:
   835 00000817 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   836 0000081A 39 D9                           	CMP	ECX,EBX
   837 0000081C 7C 13                           	JL	L220
   838 0000081E                                 L213:
   839 0000081E 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   840 00000822 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   841 00000825 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   842 00000829 49                              	DEC	ECX
   843 0000082A 89 42 18                        	MOV	DWORD [24+EDX],EAX
   844 0000082D 39 D9                           	CMP	ECX,EBX
   845 0000082F 7D ED                           	JGE	L213
   846 00000831                                 L220:
   847 00000831 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   848 00000835 FF 46 10                        	INC	DWORD [16+ESI]
   849 00000838 EB BC                           	JMP	L208
   850 0000083A                                 	GLOBAL	_sheet_refresh
   851 0000083A                                 _sheet_refresh:
   852 0000083A 55                              	PUSH	EBP
   853 0000083B 89 E5                           	MOV	EBP,ESP
   854 0000083D 53                              	PUSH	EBX
   855 0000083E 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   856 00000841 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   857 00000844 85 C0                           	TEST	EAX,EAX
   858 00000846 78 27                           	JS	L223
   859 00000848 50                              	PUSH	EAX
   860 00000849 50                              	PUSH	EAX
   861 0000084A 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   862 0000084D 89 C8                           	MOV	EAX,ECX
   863 0000084F 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   864 00000852 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   865 00000855 50                              	PUSH	EAX
   866 00000856 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   867 00000859 89 D0                           	MOV	EAX,EDX
   868 0000085B 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   869 0000085E 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   870 00000861 50                              	PUSH	EAX
   871 00000862 51                              	PUSH	ECX
   872 00000863 52                              	PUSH	EDX
   873 00000864 FF 73 20                        	PUSH	DWORD [32+EBX]
   874 00000867 E8 FFFFFAAB                     	CALL	_sheet_refreshsub
   875 0000086C 83 C4 1C                        	ADD	ESP,28
   876 0000086F                                 L223:
   877 0000086F 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   878 00000872 C9                              	LEAVE
   879 00000873 C3                              	RET
   880 00000874                                 	GLOBAL	_sheet_slide
   881 00000874                                 _sheet_slide:
   882 00000874 55                              	PUSH	EBP
   883 00000875 89 E5                           	MOV	EBP,ESP
   884 00000877 57                              	PUSH	EDI
   885 00000878 56                              	PUSH	ESI
   886 00000879 53                              	PUSH	EBX
   887 0000087A 53                              	PUSH	EBX
   888 0000087B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   889 0000087E 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   890 00000881 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   891 00000884 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   892 00000887 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   893 0000088A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   894 0000088D 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   895 00000890 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   896 00000893 89 43 10                        	MOV	DWORD [16+EBX],EAX
   897 00000896 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   898 0000089A 78 7C                           	JS	L225
   899 0000089C 6A 00                           	PUSH	0
   900 0000089E 89 F0                           	MOV	EAX,ESI
   901 000008A0 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   902 000008A3 50                              	PUSH	EAX
   903 000008A4 89 F8                           	MOV	EAX,EDI
   904 000008A6 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   905 000008A9 50                              	PUSH	EAX
   906 000008AA 56                              	PUSH	ESI
   907 000008AB 57                              	PUSH	EDI
   908 000008AC FF 75 F0                        	PUSH	DWORD [-16+EBP]
   909 000008AF E8 FFFFF838                     	CALL	_sheet_refreshmap
   910 000008B4 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   911 000008B7 FF 73 18                        	PUSH	DWORD [24+EBX]
   912 000008BA 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   913 000008BD 50                              	PUSH	EAX
   914 000008BE 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   915 000008C1 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   916 000008C4 50                              	PUSH	EAX
   917 000008C5 FF 75 10                        	PUSH	DWORD [16+EBP]
   918 000008C8 FF 75 0C                        	PUSH	DWORD [12+EBP]
   919 000008CB FF 75 F0                        	PUSH	DWORD [-16+EBP]
   920 000008CE E8 FFFFF819                     	CALL	_sheet_refreshmap
   921 000008D3 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   922 000008D6 83 C4 30                        	ADD	ESP,48
   923 000008D9 48                              	DEC	EAX
   924 000008DA 50                              	PUSH	EAX
   925 000008DB 89 F0                           	MOV	EAX,ESI
   926 000008DD 6A 00                           	PUSH	0
   927 000008DF 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   928 000008E2 50                              	PUSH	EAX
   929 000008E3 89 F8                           	MOV	EAX,EDI
   930 000008E5 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   931 000008E8 50                              	PUSH	EAX
   932 000008E9 56                              	PUSH	ESI
   933 000008EA 57                              	PUSH	EDI
   934 000008EB FF 75 F0                        	PUSH	DWORD [-16+EBP]
   935 000008EE E8 FFFFFA24                     	CALL	_sheet_refreshsub
   936 000008F3 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   937 000008F6 FF 73 18                        	PUSH	DWORD [24+EBX]
   938 000008F9 FF 73 18                        	PUSH	DWORD [24+EBX]
   939 000008FC 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   940 000008FF 50                              	PUSH	EAX
   941 00000900 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   942 00000903 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   943 00000906 50                              	PUSH	EAX
   944 00000907 FF 75 10                        	PUSH	DWORD [16+EBP]
   945 0000090A FF 75 0C                        	PUSH	DWORD [12+EBP]
   946 0000090D FF 75 F0                        	PUSH	DWORD [-16+EBP]
   947 00000910 E8 FFFFFA02                     	CALL	_sheet_refreshsub
   948 00000915 83 C4 38                        	ADD	ESP,56
   949 00000918                                 L225:
   950 00000918 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   951 0000091B 5B                              	POP	EBX
   952 0000091C 5E                              	POP	ESI
   953 0000091D 5F                              	POP	EDI
   954 0000091E 5D                              	POP	EBP
   955 0000091F C3                              	RET
   956 00000920                                 	GLOBAL	_sheet_free
   957 00000920                                 _sheet_free:
   958 00000920 55                              	PUSH	EBP
   959 00000921 89 E5                           	MOV	EBP,ESP
   960 00000923 53                              	PUSH	EBX
   961 00000924 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   962 00000927 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   963 0000092B 78 0A                           	JS	L228
   964 0000092D 6A FF                           	PUSH	-1
   965 0000092F 53                              	PUSH	EBX
   966 00000930 E8 FFFFFDBF                     	CALL	_sheet_updown
   967 00000935 58                              	POP	EAX
   968 00000936 5A                              	POP	EDX
   969 00000937                                 L228:
   970 00000937 C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   971 0000093E 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   972 00000941 C9                              	LEAVE
   973 00000942 C3                              	RET
